namespace = GFEXT_doll_leader

country_event = {
	id = GFEXT_doll_leader.9980
	title = GFEXT_doll_leader.9980.name
	desc = GFEXT_doll_leader.9980.desc

	picture = GFX_evt_cybernetics

	is_triggered_only = yes

	option = {
		name = OK
		custom_tooltip = GFEXT_doll_leader.9980.OK.tooltip
		owned_leader_list_tooltip = {
			limit = {
				GFEXT_has_doll_leader_flag = no
				GF_is_doll_leader = yes
			}
		}
		custom_tooltip = GFEXT_doll_leader.9980.OK.tooltip_color_end
		hidden_effect = {
			country_event = { id = GFEXT_doll_leader.9981 }
		}
	}

	option = {
		name = CANCEL
	}
}

country_event = {
	id = GFEXT_doll_leader.9981
	hide_window = yes

	is_triggered_only = yes

	immediate = {
		random_owned_leader = {
			limit = {
				GFEXT_has_doll_leader_flag = no
				GF_is_doll_leader = yes
			}
			prev = {
				country_event = {
					id = GFEXT_doll_leader.9990
					scopes = { from = prev }
				}
			}
		}
		if = {
			limit = {
				any_owned_leader = {
					GFEXT_has_doll_leader_flag = no
					GF_is_doll_leader = yes
				}
			}
			country_event = {
				id = GFEXT_doll_leader.9981
				days = 1
			}
		}
		else = {
			country_event = {
				id = GFEXT_doll_leader.9982
				days = 1
			}
		}
	}
}

country_event = {
	id = GFEXT_doll_leader.9982
	hide_window = yes

	is_triggered_only = yes
	trigger = {
		any_envoy = {
			GFEXT_has_doll_leader_flag = no
			GF_is_doll_leader = yes
		}
	}

	immediate = {
		random_envoy = {
			limit = {
				GFEXT_has_doll_leader_flag = no
				GF_is_doll_leader = yes
			}
			prev = {
				country_event = {
					id = GFEXT_doll_leader.9990
					scopes = { from = prev }
				}
			}
		}
		country_event = {
			id = GFEXT_doll_leader.9982
			days = 1
		}
	}
}

country_event = {
	id = GFEXT_doll_leader.9990
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		has_global_flag = GF_Stellairs_Crisis_Coalition_Enabled
		from = { GF_is_doll_leader = yes }
	}

	immediate = {
		from = { GFEXT_set_random_doll_leader_portrait_and_name = yes }
	}
}

event = {
	id = GFEXT_doll_leader.9991
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		has_global_flag = GF_Stellairs_Crisis_Coalition_Enabled
	}

	immediate = {
		every_country = {
			country_event = {
				id = GFEXT_doll_leader.9992
			}
		}
	}
}

country_event = {
	id = GFEXT_doll_leader.9992
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		every_owned_leader = {
			limit = { GF_is_doll_leader = yes }
			GFEXT_correct_doll_leader_portrait_and_name = yes
		}
		every_envoy = {
			limit = { GF_is_doll_leader = yes }
			GFEXT_correct_doll_leader_portrait_and_name = yes
		}
	}
}